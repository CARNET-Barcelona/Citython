---
title: "Tutorial: ggmap"
author: "Manuel Gij?n Agudo"
date: "12 de julio de 2018"
output:
  pdf_document:
    toc: yes
    toc_depth: 2
  html_document:
    toc: yes
    toc_depth: 2
    toc_float: yes
bibliography: maps.bib
lang: en 
---

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

## GGMAP

This package has the same structure and philosophy than ggplot but for georeferencial information. 

First load the package in your script.

```{r cars}
#install.packages('ggmap')    # uncomented to intall the library if need it
library(ggmap)
```

### First steeps

There exits some APIs that are able to return a geometrical point, the one that we use the most is Google. 

The **geocode** function ask the API and returns the coordinates of the point in a data.frame.

```{r pressure, echo=True}
point <- geocode('Calle Ample 4, Barcelona, EspaÃ±a')
names(point)      # we can check the names of the returned data.frame object

print(point$lon)
print(point$lat)
```

The backwards function: from a pair (lon, lat) we obtain the direction it keeps.

```{r pressure, echo=True}
place <- revgeocode(as.numeric(point))
```

The function get_map consults another API and download a map. The function has some paramethers:

```{r presure, echo=True}
map.point <- get.map(location=as.numeric(point),
                      color="color",
                      maptype="roadmap",
                      scale=2,
                      zoom=16)
```

This two functions requires an internet conection, the next one and we can use it to represent information saved in variables, like points for example.

#### ggmap

```{r presure, echo=True}
ggmap(map.unizar) + geom_point(aes(x = lon, y = lat),
                               data = unizar, 
                               colour="red",
                               size = 4)

```

We can work here like we work with ggplot functions, combining the functions of this package to do awsome visualizations.

#### qmap
```{r pressure, echo=FALSE}
qmap(location = "Barcelona")
```

Zoom = 10 as the default value.


map zoom, an integer from 3 (continent) to 21 (building), default value 10 (city).


```{r pressure, echo=TRUE}
qmap(location = "barcelona", zoom = 15)
```



```{r pressure, echo=TRUE}
qmap(location = "barcelona", maptype = "satellite")
```

```{r pressure, echo=TRUE}
qmap(location = "barcelona", maptype = "hybrid")
```

```{r pressure, echo=TRUE}
qmap(location = "barcelona", maptype = "toner")
```

```{r pressure, echo=TRUE}
qmap(location = "barcelona",  maptype = "watercolor")
```

```{r pressure, echo=TRUE}
qmap(location = "barcelona", maptype = "terrain-background")
```


```{r pressure, echo=TRUE}
qmap(location = "barcelona", maptype = "toner-lite")
```

#### get_map

maptype
character string providing map theme. options available are "terrain", "terrain-background", "satellite", "roadmap", and "hybrid" (google maps), "terrain", "watercolor", and "toner" (stamen maps), or a positive integer for cloudmade maps (see ?get_cloudmademap)


get_map(location = c(lon = -95.3632715, lat = 29.7632836), zoom = "auto", scale = "auto", maptype = c("terrain", "terrain-background", "satellite", "roadmap", "hybrid", "toner", "watercolor", "terrain-labels", "terrain-lines", "toner-2010", "toner-2011", "toner-background", "toner-hybrid", "toner-labels", "toner-lines", "toner-lite"), source = c("google", "osm", "stamen", "cloudmade"), force = ifelse(source == "google", TRUE, TRUE), messaging = FALSE, urlonly = FALSE, filename = "ggmapTemp", crop = TRUE, color = c("color", "bw"), language = "en-EN", api_key)
```{r pressure, echo=TRUE}
map <- get_map()
map
str(map)
ggmap(map)
```

, filename = "test.jpg"

```{r pressure, echo=TRUE}
map <- get_map(location = "Barcelona", zoom = 6, source = "google")
ggmap(map, fullpage = TRUE)
```




#### ggmap

Sirve para mostrar los objetos ggmap

```{r, echo=TRUE}
map <- get_map(location = "Barcelona", zoom = 6, source = "google")
ggmap(map)
```


extent
how much of the plot should the map take up? "normal", "device", or "panel" (default)


```{r, echo=TRUE}
map <- get_map(location = "Barcelona", zoom = 6, source = "google")
ggmap(map, extent="device")
ggmap(map, extent="normal")
ggmap(map, extent="panel") # default
``` 



legend
"left", "right" (default), "bottom", "top", "bottomleft", "bottomright", "topleft", "topright", "none" (used with extent = "device")



padding
distance from legend to corner of the plot (used with legend, formerly b)

















